# Diff Main Machine

### Описание

__Diff Main Machine__ - сервер, который работает на веб сокетах.

### Возможности:
- Подключение и регистрация модулей различных типов (подробнее о типа см. ниже)
- Обработка diff
- Хранение diff для повторного использования
- Хранение исходников библиотек

### Документация:
Перед началом работы каждый модуль должен зарегистрироваться. Для этого после откртия канала через web socket необходимо прислать серверу команду __setModuleType__ с типом подключенного модуля.

Возможные типы:
- __interface__ - интерфейс
- __documentation__ - модуль нахождения diff по документации
- __code__ - модуль нахождения diff по коду
- __fat model code__ - модуль, строящий model по коду
- __source migrate__ - модуль, для миграции с одной версии библиотеки на другую
- __diff machine__ - модуль, нахождения diff по fat model

Команда отправляется с помощью JSON.

Пример команды:

``` js
    {
     "cmd" : "setModuleType"
     "data" : "interface"
    }
```

Далее предложен список команд:

 #### getDirs
Получить все библиотеки, хранящиеся на сервере

Пример:

``` js
    {
      "cmd" : "getDirs"
    }
```

 #### getDirs
 Получить директорию по указанному пути

 Пример:

 ``` js
    {
      "cmd" : "getDir"
      "data" : "path\to\dir"
    }
```

#### getFile
 Получить файл по указанному пути

 Пример:

 ``` js
    {
      "cmd" : "getFile"
      "data" : "path\to\file"
    }
```

#### getDiffs
 Получить __diff__ для указанных файлов

 Пример:

 ``` js
    {
      "cmd" : "getDiff"
      "data" : {
        "libV1Path" : "path\to\file"
        "libV2Path" : "path\to\file"
      }
    }
```

#### pushDiff
 команда используется при отправлении на сервер списка найденных __diff__

 Пример:

 ``` js
    {
      "cmd" : "pushDiff"
      "data" : {diffList}
    }
```
__diffList__ - список найденных __diff__

#### pushModel
 команда используется при отправлении на сервер __xml__ модели кода

 Пример:

 ``` js
    {
      "cmd" : "pushModel"
      "data" : {xmlModel}
    }
```
__xmlModel__ - __xml__ модель по коду

